
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COVID-19 Interactive Data Visualization Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #dashboard-container {
            margin: 20px;
        }
        .plot-container {
            margin-top: 30px;
        }
    </style>
</head>
<body>
<div id="dashboard-container" class="container">
    <h1>COVID-19 Interactive Data Visualization Dashboard</h1>
    <div class="form-group">
        <label for="country-select">Select Country to Visualize:</label>
        <select id="country-select" class="form-control" multiple>
        </select>
    </div>
    <div id="summary-output"></div>
    <div id="country-graph" class="plot-container"></div>
    <div class="plot-container">
        <h4>Total Overview Globally</h4>
        <div id="world-graph"></div>
    </div>
</div>

<script>
    function fetchData() {
        return $.ajax({
            url: "https://api.covid19api.com/summary",
            type: "GET",
            dataType: "json"
        });
    }

    function updateCountryOptions(data) {
        const dropdown = $('#country-select');
        dropdown.empty();
        data.Countries.forEach(country => {
            dropdown.append(new Option(country.Country, country.Country));
        });
    }

    function updateWorldGraph(data) {
        const topCountries = data.Countries.sort((a, b) => b.TotalConfirmed - a.TotalConfirmed).slice(0, 10);
        const countryNames = topCountries.map(country => country.Country);
        const totalConfirmed = topCountries.map(country => country.TotalConfirmed);

        const trace = {
            x: countryNames,
            y: totalConfirmed,
            type: 'bar',
            name: 'Total Confirmed Cases'
        };

        const layout = {
            title: 'Top 10 Countries with Highest Confirmed Cases',
            xaxis: { title: 'Country' },
            yaxis: { title: 'Total Confirmed Cases' }
        };

        Plotly.newPlot('world-graph', [trace], layout);
    }

    function updateCountryGraph(selectedCountries, data) {
        if (!selectedCountries.length) {
            $('#country-graph').html('<h5>Select a Country to See Detailed Information</h5>');
            return;
        }

        const selectedData = data.Countries.filter(country => selectedCountries.includes(country.Country));

        const traces = [
            {
                x: selectedData.map(country => country.Country),
                y: selectedData.map(country => country.TotalConfirmed),
                type: 'bar',
                name: 'Total Confirmed'
            },
            {
                x: selectedData.map(country => country.Country),
                y: selectedData.map(country => country.TotalDeaths),
                type: 'bar',
                name: 'Total Deaths'
            },
            {
                x: selectedData.map(country => country.Country),
                y: selectedData.map(country => country.TotalRecovered),
                type: 'bar',
                name: 'Total Recovered'
            }
        ];

        const layout = {
            title: 'COVID-19 Statistics by Country',
            barmode: 'group',
            xaxis: { title: 'Country' },
            yaxis: { title: 'Count' }
        };

        Plotly.newPlot('country-graph', traces, layout);
    }

    $(document).ready(function () {
        fetchData().done(data => {
            updateCountryOptions(data);
            updateWorldGraph(data);

            $('#country-select').change(function () {
                const selectedCountries = $(this).val();
                updateCountryGraph(selectedCountries, data);
            });
        }).fail(() => {
            alert('Failed to fetch data from the API.');
        });
    });
</script>
</body>
</html>
